// Copyright 2007 - 2010 Gennadiy Shvets
// The program is distributed under the terms of the GNU General
// Public License 3.0
//
// See http://www.allmyscripts.com/Table_Sort/index.html for usage details.
// Script version 1.8
function TSort_StoreDef(){this.sorting=[],this.nodes=[],this.rows=[],this.row_clones=[],this.sort_state=[],this.initialized=0,this.history=[],this.sort_keys=[],this.sort_colors=["#FF0000","#800080","#0000FF"]}function tsInitOnload(){TSort_All==null&&tsRegister();for(var a in TSort_All)tsSetTable(a),tsInit();window.onload_sort_table&&window.onload_sort_table()}function tsInit(){if(TSort_Data.push==null)return;var a=TSort_Data[0],b=document.getElementById(a),c=b.getElementsByTagName("thead")[0];if(c==null){alert("Cannot find THEAD tag!");return}var d=c.getElementsByTagName("tr"),e,f,g,h;if(d.length>1){var i=d[0].getElementsByTagName("th");i.length==0&&(i=d[0].getElementsByTagName("td"));var k,k=d[1].getElementsByTagName("th");k.length==0&&(k=d[1].getElementsByTagName("td")),e=new Array;var l,m,n;h=i.length;for(l=0,m=0;l<h;l++){g=i[l],n=g.colSpan;if(n>1)while(n>0)e.push(k[m++]),n--;else g.rowSpan==1&&m++,e.push(g)}}else e=d[0].getElementsByTagName("th"),e.length==0&&(e=d[0].getElementsByTagName("td"));h=e.length;for(var f=0;f<h;f++){if(f>=TSort_Data.length-1)break;g=e[f];var o=TSort_Data[f+1].toLowerCase();o==null&&(o=""),TSort_Store.sorting.push(o),o!=null&&o!=""&&(g.innerHTML="<a href='' onClick=\"tsDraw("+f+",'"+a+"'); return false\">"+g.innerHTML+'</a><b><span id="TS_'+f+"_"+a+'"></span></b>',g.style.cursor="pointer")}var p=b.getElementsByTagName("tbody")[0];if(p==null)return;var q=p.getElementsByTagName("tr"),r=new Date,h,s,t;for(f=0;f<q.length;f++){var u=q[f],e=u.getElementsByTagName("td"),v=[];for(j=0;j<e.length;j++){s=e[j].innerHTML.replace(/^\s+/,""),s=s.replace(/\s+$/,"");var o=TSort_Store.sorting[j];o=="h"?(s=s.replace(/<[^>]+>/g,""),s=s.toLowerCase()):o=="s"?s=s.toLowerCase():o=="i"?(s=parseInt(s),isNaN(s)&&(s=0)):o=="n"?(s=s.replace(/(\d)\,(?=\d\d\d)/g,"$1"),s=parseInt(s),isNaN(s)&&(s=0)):o=="c"?(s=s.replace(/^\$/,""),s=s.replace(/(\d)\,(?=\d\d\d)/g,"$1"),s=parseFloat(s),isNaN(s)&&(s=0)):o=="f"?(s=parseFloat(s),isNaN(s)&&(s=0)):o=="g"?(s=s.replace(/(\d)\,(?=\d\d\d)/g,"$1"),s=parseFloat(s),isNaN(s)&&(s=0)):o=="d"&&(s.match(/^\d\d\d\d\-\d\d?\-\d\d?(?: \d\d?:\d\d?:\d\d?)?$/)?(t=s.split(/[\s\-:]/),s=t[3]==null?Date.UTC(t[0],t[1]-1,t[2],0,0,0,0):Date.UTC(t[0],t[1]-1,t[2],t[3],t[4],t[5],0)):s=Date.parse(s)),v.push(s)}TSort_Store.rows.push(v);var w=u.cloneNode(!0);w.tsort_row_id=f,TSort_Store.row_clones[f]=w}TSort_Store.initialized=1;if(TSort_Store.cookie){var x=document.cookie;f=x.indexOf(TSort_Store.cookie+"="),f!=-1&&(f+=TSort_Store.cookie.length+1,h=x.indexOf(";",f),s=decodeURIComponent(x.substring(f,h==-1?x.length:h)),TSort_Store.initial=s==""?null:s.split(/\s*,\s*/))}var y=TSort_Store.initial;if(y!=null){var z=typeof y;if(z=="number"||z=="string")tsDraw(y);else for(f=y.length-1;f>=0;f--)tsDraw(y[f])}}function tsDraw(a,b){b!=null&&tsSetTable(b);if(TSort_Store==null||TSort_Store.initialized==0)return;var c=0,d=TSort_Store.sort_keys,e,f="";a!=null&&(typeof a=="number"?e=a:typeof a=="string"&&a.match(/^\d+[ADU]$/i)&&(e=a.replace(/^(\d+)[ADU]$/i,"$1"),f=a.replace(/^\d+([ADU])$/i,"$1").toUpperCase())),e==null&&(e=this.tsort_col_id,b==null&&this.tsort_table_id!=null&&tsSetTable(this.tsort_table_id));var g=TSort_Data[0],h=TSort_Store.sort_state[e];f=="U"?h!=null&&(TSort_Store.sort_state[e]=null,r=document.getElementById("TS_"+e+"_"+g),r!=null&&(r.innerHTML="")):f!=""?(TSort_Store.sort_state[e]=f=="A"?!0:!1,d.unshift(e),c=1):h==null||h==1?(TSort_Store.sort_state[e]=h==null?!0:!1,d.unshift(e),c=1):(TSort_Store.sort_state[e]=null,r=document.getElementById("TS_"+e+"_"+g),r!=null&&(r.innerHTML=""));var i=d.length;while(c<i){if(d[c]==e){d.splice(c,1),i--;break}c++}i>3&&(c=d.pop(),r=document.getElementById("TS_"+c+"_"+g),r!=null&&(r.innerHTML=""),TSort_Store.sort_state[c]=null),TSort_Store.row_clones.sort(tsSort);var j=document.createElement("tbody"),k=TSort_Store.row_clones;i=k.length;var l=TSort_Store.classes;if(l==null)for(c=0;c<i;c++)j.appendChild(k[c].cloneNode(!0));else{var m,n=0,o=l.length;for(c=0;c<i;c++)m=k[c].cloneNode(!0),m.className=l[n++],n>=o&&(n=0),j.appendChild(m)}var p=document.getElementById(g),q=p.getElementsByTagName("tbody")[0];p.removeChild(q),p.appendChild(j);var r,s,t,u;i=d.length;var v=new Array;for(c=0;c<i;c++){e=d[c],r=document.getElementById("TS_"+e+"_"+g);if(r==null)continue;u=TSort_Store.sort_state[e]?0:1,t=TSort_Store.icons[u],r.innerHTML=t.match(/</)?t:'<font color="'+TSort_Store.sort_colors[c]+'">'+t+"</font>",v.push(e+(u?"D":"A"))}if(TSort_Store.cookie){var w=new Date;w.setTime(w.getTime()+2592e3),document.cookie=TSort_Store.cookie+"="+encodeURIComponent(v.join(","))+"; expires="+w.toGMTString()+"; path=/"}}function tsSort(a,b){var c=TSort_Store.rows[a.tsort_row_id],d=TSort_Store.rows[b.tsort_row_id],e=TSort_Store.sort_keys,f=e.length,g,h,i,j;for(var k=0;k<f;k++){g=e[k],h=TSort_Store.sorting[g];var l=c[g],m=d[g];if(l==m)continue;return h=="i"||h=="f"||h=="d"?j=l-m:j=l<m?-1:1,i=TSort_Store.sort_state[g],i?j:0-j}return a.tsort_row_id<b.tsort_row_id?-1:1}function tsRegister(){TSort_All==null&&(TSort_All=new Object);var a=new TSort_StoreDef;a.sort_data=TSort_Data,TSort_Data=null,typeof TSort_Classes!="undefined"&&(a.classes=TSort_Classes,TSort_Classes=null),typeof TSort_Initial!="undefined"&&(a.initial=TSort_Initial,TSort_Initial=null),typeof TSort_Cookie!="undefined"&&(a.cookie=TSort_Cookie,TSort_Cookie=null),typeof TSort_Icons!="undefined"&&(a.icons=TSort_Icons,TSort_Icons=null),a.icons==null&&(a.icons=new Array("↓","↑")),a.sort_data!=null&&(TSort_All[a.sort_data[0]]=a)}function tsSetTable(a){TSort_Store=TSort_All[a];if(TSort_Store==null){alert("Cannot set table '"+a+"' - table is not registered");return}TSort_Data=TSort_Store.sort_data}var TSort_Store,TSort_All;window.addEventListener?window.addEventListener("load",tsInitOnload,!1):window.attachEvent?window.attachEvent("onload",tsInitOnload):(window.onload_sort_table==null&&window.onload!=null&&(window.onload_sort_table=window.onload),window.onload=tsInitOnload);